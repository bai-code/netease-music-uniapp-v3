import{u as e,f as a,aa as t,g as s,k as l,l as i,o as u,c as n,w as c,a as o,b as r,t as d,D as m,B as f,F as g,C as _,i as p,d as v,q as h,a7 as k,e as I,ad as b,m as y,E as x,ae as w,_ as S,af as C,ag as $,a3 as j,I as M,J as q}from"./index.88361eb6.js";import{_ as P}from"./u-loading-icon.f23f30cd.js";import{_ as z}from"./music-list-table.1b59f8b2.js";import{_ as L}from"./_plugin-vue_export-helper.cdc0426e.js";import{_ as D}from"./video-temp.bdb93370.js";import"./u-icon.0263866c.js";import"./u-line.c1c06170.js";const F=L({__name:"singer-album",props:{singerId:{type:[String,Number],required:!0}},setup(k,{expose:I}){const b=k,y=e(),x=a(-1),w=a(0),S=a(!0),C=a([]),$=a([]),j=t([]),M=a(!0),q=async e=>{const a=j.length||0,{hotAlbums:t,more:s}=await y.dispatch("getInfo",{path:`/artist/album?id=${e}&limit=5&offset=${a}`});j.push(...t),M.value=s,j.forEach(((e,a)=>{e._songs||(w.value+=1,(async(e,a)=>{const{songs:t=[]}=await y.dispatch("getInfo",{path:`/album?id=${e}`});j[a]._songs=t,w.value-=1})(e.id,a))}))};s((()=>b.singerId),(e=>{(async e=>{const{hotSongs:a}=await y.dispatch("getInfo",{path:`/artists?id=${e}`});C.value=a,$.value=C.value.slice(0,5)})(e),q(e)}),{immediate:!0});return I({loadMore:()=>{M.value&&0===w.value&&q(b.singerId)}}),(e,a)=>{const t=p,s=l(i("music-list-table"),z),k=v,I=h;return u(),n(t,{class:"singer-album"},{default:c((()=>[$.value.length?(u(),n(t,{key:0,class:"hot-50"},{default:c((()=>[o(t,{class:"title"},{default:c((()=>[r(" 热门50首 ")])),_:1}),o(s,{class:"music-list",musicList:$.value,showImage:!1},null,8,["musicList"]),S.value?(u(),n(t,{key:0,class:"show-more",onClick:a[0]||(a[0]=e=>($.value=C.value,S.value=!1))},{default:c((()=>[o(k,null,{default:c((()=>[r("查看全部 "+d(C.value.length)+" 首",1)])),_:1}),o(k,{class:"iconfont icon-right"})])),_:1})):m("",!0)])),_:1})):m("",!0),j.length?(u(),n(t,{key:1,class:"album-list"},{default:c((()=>[(u(!0),f(g,null,_(j,((e,a)=>(u(),n(t,{class:"album-item",key:e.id},{default:c((()=>[o(t,{class:"album-item-title"},{default:c((()=>[r(d(e.name),1)])),_:2},1024),o(t,{class:"list"},{default:c((()=>[o(t,{class:"image"},{default:c((()=>[o(I,{src:e.blurPicUrl,mode:"scaleToFill"},null,8,["src"])])),_:2},1024),e._songs?(u(),n(t,{key:0,class:"music-list-content"},{default:c((()=>[o(s,{class:"music-list",musicList:e._songs.slice(0,x.value===a?-1:5),showImage:!1},null,8,["musicList"]),x.value!==a&&e._songs.length>10?(u(),n(t,{key:0,class:"show-more",onClick:e=>x.value=a},{default:c((()=>[o(k,null,{default:c((()=>[r("查看全部 "+d(e._songs.length)+" 首",1)])),_:2},1024),o(k,{class:"iconfont icon-right"})])),_:2},1032,["onClick"])):m("",!0)])),_:2},1024)):m("",!0)])),_:2},1024)])),_:2},1024)))),128))])),_:1})):m("",!0)])),_:1})}}},[["__scopeId","data-v-7b7a192c"]]),T=L({__name:"singer-mv",props:{singerId:{type:String,required:!0}},setup(o,{expose:r}){const d=o,m=e(),v=t([]),h=a(!0),k=async e=>{const a=v.length,{mvs:t,hasMore:s}=await m.dispatch("getInfo",{path:`/artist/mv?id=${e}&offset=${a}&limit=10`});v.push(...t),h.value=s};return s((()=>d.singerId),(e=>{k(e)}),{immediate:!0}),r({loadMore:()=>{h.value&&k(d.singerId)}}),(e,a)=>{const t=l(i("video-temp"),D),s=p;return u(),n(s,{class:"singer-mv"},{default:c((()=>[(u(!0),f(g,null,_(v,(e=>(u(),n(t,{videoInfo:e,imageName:"imgurl",key:e.id},null,8,["videoInfo"])))),128))])),_:1})}}},[["__scopeId","data-v-bf447c31"]]),E=L({__name:"singer-description",props:{singerId:{type:String,required:!0}},setup(t){const l=t,i=e(),m=a(""),v=a([]);a([]);return s((()=>l.singerId),(e=>{(async e=>{const{briefDesc:a,introduction:t,topicData:s}=await i.dispatch("getInfo",{path:`/artist/desc?id=${e}`});m.value=a,v.value=t.map((e=>-1!==e.txt.indexOf("\n")?{ti:e.ti,_txt:e.txt.split("\n")}:{ti:e.ti,txt:e.txt})),k("log","at subPackages/singer-detail/singer-description.vue:73",v.value,s)})(e)}),{immediate:!0}),(e,a)=>{const t=p;return u(),n(t,{class:"singer-description"},{default:c((()=>[o(t,{class:"introduce"},{default:c((()=>[o(t,{class:"desc-title gutter title"},{default:c((()=>[r(" 简介 ")])),_:1}),o(t,{class:"desc-text gutter2 textIndent"},{default:c((()=>[r(d(m.value),1)])),_:1}),o(t,{class:"introd"},{default:c((()=>[(u(!0),f(g,null,_(v.value,((e,a)=>(u(),f(g,{key:a},[o(t,{class:"title gutter title"},{default:c((()=>[r(d(e.ti),1)])),_:2},1024),o(t,{class:"txt gutter2 textIndent"},{default:c((()=>[e._txt?(u(!0),f(g,{key:0},_(e._txt,((e,a)=>(u(),n(t,{class:"desc-item",key:a},{default:c((()=>[r(d(e),1)])),_:2},1024)))),128)):(u(),n(t,{key:1,class:"item"},{default:c((()=>[r(d(e.txt),1)])),_:2},1024))])),_:2},1024)],64)))),128))])),_:1}),o(t,{class:"topic"})])),_:1})])),_:1})}}},[["__scopeId","data-v-25631d49"]]),N=L({__name:"singer-similar",props:{singerId:{type:String,required:!0}},setup(a){const t=a,s=e(),l=I((()=>s.state.userInfo.userInfo.token));b((()=>{k("log","at subPackages/singer-detail/singer-similar.vue:36",l.value),l.value&&(async e=>{const a=await s.dispatch("getInfo",{path:`/simi/artist?id=${e}`});k("log","at subPackages/singer-detail/singer-similar.vue:28",a)})(t.singerId)}));const i=()=>{x({url:"/subPackages/user-login/user-login"})};return(e,a)=>{const t=p;return y(l)?(u(),n(t,{key:0,class:"similar-contianer"},{default:c((()=>[r(" 无法登录， 数据暂时无法获取 ")])),_:1})):(u(),n(t,{key:1,class:"no-login"},{default:c((()=>[o(t,{class:"login",onClick:i},{default:c((()=>[r(" 登录获取信息 ")])),_:1})])),_:1}))}}},[["__scopeId","data-v-75ddd3f4"]]),U=L({__name:"singer-detail",setup(t){const s=e(),k=a(0),I=a(),b=w([{id:0,text:"专辑",cmp:F},{id:1,text:"MV",cmp:T},{id:2,text:"歌手详情",cmp:E},{id:3,text:"相似歌手",cmp:N}]),x=a(0),z=a({}),L=()=>{j({title:"建设中...",icon:"none"})},D=a(!1),U=()=>{D.value=!0,I.value.loadMore?(I.value.loadMore(),D.value=!0):D.value=!1},V=a(0),A=a(!1),B=e=>{const{scrollTop:a}=e.detail;A.value=a>=600,V.value=a},J=()=>{V.value=0};return S((e=>{(async e=>{const{data:a={}}=await s.dispatch("getInfo",{path:`/artist/detail?id=${e}`});z.value=a})(e.id),k.value=e.id})),(e,a)=>{const t=h,s=p,w=v,S=l(i("u-loading-icon"),P),j=M;return u(),n(s,{class:"singer-detail"},{default:c((()=>[o(j,{"scroll-y":"true",class:"singer-content",onScrolltolower:U,"lower-threshold":"200",onScroll:B,"scroll-top":V.value,"enable-back-to-top":"","scroll-with-animation":""},{default:c((()=>[z.value.artist?(u(),n(s,{key:0,class:"detail-info"},{default:c((()=>[o(s,{class:"image"},{default:c((()=>[o(t,{src:z.value.user&&z.value.user.avatarUrl||z.value.artist.cover,mode:"scaleToFill"},null,8,["src"])])),_:1}),o(s,{class:"info"},{default:c((()=>[o(s,{class:"nickname"},{default:c((()=>[r(d(z.value.artist.name),1)])),_:1}),z.value.artist.alias?(u(),n(s,{key:0,class:"alias gutter"},{default:c((()=>[r(d(z.value.artist.alias[0]),1)])),_:1})):m("",!0),o(s,{class:"function gutter"},{default:c((()=>[o(s,{class:"personal-homepage",onClick:L},{default:c((()=>[o(w,{class:"iconfont icon-personal"}),o(w,null,{default:c((()=>[r("个人主页")])),_:1})])),_:1})])),_:1}),o(s,{class:"other gutter"},{default:c((()=>[o(s,{class:"single-music gutter"},{default:c((()=>[o(w,null,{default:c((()=>[r("单曲数: ")])),_:1}),o(w,null,{default:c((()=>[r(d(z.value.artist.musicSize),1)])),_:1})])),_:1}),o(s,{class:"album gutter"},{default:c((()=>[o(w,null,{default:c((()=>[r("专辑数: ")])),_:1}),o(w,null,{default:c((()=>[r(d(z.value.artist.albumSize),1)])),_:1})])),_:1}),o(s,{class:"mv gutter"},{default:c((()=>[o(w,null,{default:c((()=>[r("MV数: ")])),_:1}),o(w,null,{default:c((()=>[r(d(z.value.artist.mvSize),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})):m("",!0),z.value.artist?(u(),n(s,{key:1,class:"singer-description"},{default:c((()=>[o(s,{class:"cmp-title"},{default:c((()=>[(u(!0),f(g,null,_(y(b),((e,a)=>(u(),n(s,{class:q(["cmp-item",{active:x.value===a}]),key:e.id,onClick:e=>(e=>{x.value=e})(a)},{default:c((()=>[r(d(e.text),1)])),_:2},1032,["class","onClick"])))),128))])),_:1}),(u(),n(C,null,[(u(),n(i(y(b)[x.value].cmp),{ref_key:"cmpRef",ref:I,singerId:k.value},null,8,["singerId"]))],1024))])),_:1})):m("",!0),o($,{name:"scroll"},{default:c((()=>[A.value?(u(),n(s,{key:0,class:"back-top",onClick:J},{default:c((()=>[o(w,{class:"iconfont icon-back-top"})])),_:1})):m("",!0)])),_:1}),D.value?(u(),n(S,{key:2,text:"加载中",textSize:"18"})):m("",!0)])),_:1},8,["scroll-top"])])),_:1})}}},[["__scopeId","data-v-caa62b23"]]);export{U as default};
