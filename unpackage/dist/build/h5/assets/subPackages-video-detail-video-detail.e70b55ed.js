import{u as e,k as l,l as a,o as t,c as s,w as o,a as n,b as c,t as u,B as m,F as d,C as i,D as f,m as r,a2 as v,a3 as _,q as p,i as h,d as y,f as I,_ as k,a4 as g,I as b}from"./index.88361eb6.js";import{_ as w}from"./u-line.c1c06170.js";import{_ as x}from"./_plugin-vue_export-helper.cdc0426e.js";import{_ as j}from"./u-loading-icon.f23f30cd.js";const C=x({__name:"comment",props:{commentInfo:{type:Object,default:()=>({})},typeId:{type:String,default:""},typeKind:{type:String,default:"mv"}},setup(I){e();return(e,k)=>{const g=p,b=h,x=l(a("u-line"),w),j=y;return I.commentInfo.user?(t(),s(b,{key:0,class:"comment"},{default:o((()=>[n(b,{class:"comment-left"},{default:o((()=>[n(g,{"lazy-load":"",src:I.commentInfo.user.avatarUrl,mode:"scaleToFill"},null,8,["src"])])),_:1}),n(b,{class:"comment-right"},{default:o((()=>[n(b,{class:"publish-user overflow"},{default:o((()=>[c(u(I.commentInfo.user.nickname),1)])),_:1}),n(b,{class:"reply-txt"},{default:o((()=>[c(u(I.commentInfo.content),1)])),_:1}),I.commentInfo.beReplied.length>0?(t(),s(b,{key:0,class:"reply"},{default:o((()=>[(t(!0),m(d,null,i(I.commentInfo.beReplied,((e,l)=>(t(),s(b,{class:"commentInfo-reply"},{default:o((()=>[n(b,{class:"reply-image"},{default:o((()=>[n(g,{"lazy-load":"",src:e.user.avatarUrl,mode:"scaleToFill"},null,8,["src"])])),_:2},1024),n(b,{class:"reply-content"},{default:o((()=>[n(b,{class:"user overflow"},{default:o((()=>[c(u(e.user.nickname),1)])),_:2},1024),n(b,{class:"reply-txt"},{default:o((()=>[c(u(e.content),1)])),_:2},1024),l!=I.commentInfo.beReplied.length-1?(t(),s(x,{key:0})):f("",!0)])),_:2},1024)])),_:2},1024)))),256))])),_:1})):f("",!0),n(b,{class:"other"},{default:o((()=>[n(j,{class:"time"},{default:o((()=>[c(u(I.commentInfo.timeStr),1)])),_:1}),n(b,{class:"like",onClick:k[0]||(k[0]=e=>(I.commentInfo.liked,void _({title:"暂未实现",icon:"error"})))},{default:o((()=>[I.commentInfo.liked?(t(),s(j,{key:0,class:"iconfont icon-like_active"})):(t(),s(j,{key:1,class:"iconfont icon-like"})),n(j,{class:"count"},{default:o((()=>[c(u(r(v)(I.commentInfo.likedCount)),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})):f("",!0)}}},[["__scopeId","data-v-fb2f6b2d"]]),S=x({__name:"video-detail",setup(r){const v=e(),_=I({}),w=I(0),x=I(!1);I(!1);const S=I([]),$=I([]),F=I(!1),R=I(!1),T=async e=>{const l=$.value.length,{comments:a=[],hotComments:t=[],more:s=!1,moreHot:o=!1}=await v.dispatch("getInfo",{path:`/comment/mv?id=${e}&offset=${l}`});t.length>0&&S.value.push(...t),$.value.push(...a),F.value=s,R.value=o,x.value=!1},U=()=>{F.value&&T(w.value)};return k((e=>{const{mvId:l,vid:a}=e;w.value=l||a,v.commit("pause"),w.value&&(x.value=!0,(async e=>{const{data:l={}}=await v.dispatch("getInfo",{path:`/mv/detail?mvid=${e}`});Object.assign(_.value,l)})(w.value),(async e=>{const{data:l={}}=await v.dispatch("getInfo",{path:`/mv/url?id=${e}`});_.value.src=l.url})(w.value),T(w.value))})),(e,r)=>{const v=g,I=h,k=p,w=y,F=l(a("comment"),C),T=l(a("u-loading-icon"),j),z=b;return t(),s(I,{class:"video-detail"},{default:o((()=>[n(I,{class:"video"},{default:o((()=>[n(v,{src:_.value.src},null,8,["src"])])),_:1}),n(z,{class:"video-content","scroll-y":"","lower-threshold":200,onScrolltolower:U},{default:o((()=>[n(I,{class:""},{default:o((()=>[_.value.artists?(t(),s(I,{key:0,class:"info"},{default:o((()=>[n(k,{src:_.value.artists[0].img1v1Url,mode:""},null,8,["src"]),n(I,{class:"title overflow"},{default:o((()=>[c(u(_.value.artists[0].name),1)])),_:1})])),_:1})):f("",!0),n(I,{class:"desc"},{default:o((()=>[c(u(_.value.name),1)])),_:1}),n(I,{class:"time"},{default:o((()=>[n(I,{class:"publish-time"},{default:o((()=>[n(w,null,{default:o((()=>[c("发布时间 :")])),_:1}),n(w,{class:"time"},{default:o((()=>[c(u(_.value.publishTime),1)])),_:1})])),_:1})])),_:1}),n(I,{class:"comment-container"},{default:o((()=>[S.value.length?(t(),s(I,{key:0,class:"hot-comment"},{default:o((()=>[n(I,{class:"comment-title show-txt"},{default:o((()=>[c(" 热门评论 ")])),_:1}),n(I,{class:"comment"},{default:o((()=>[(t(!0),m(d,null,i(S.value,(e=>(t(),s(F,{key:e.id,commentInfo:e},null,8,["commentInfo"])))),128))])),_:1}),R.value?(t(),s(I,{key:0,class:"has-more",onClick:r[0]||(r[0]=l=>U(e.mvId))},{default:o((()=>[n(w,null,{default:o((()=>[c("加载更多")])),_:1}),n(w,{class:"iconfont icon-right"})])),_:1})):f("",!0)])),_:1})):f("",!0),$.value.length?(t(),s(I,{key:1,class:"hot-comment"},{default:o((()=>[n(I,{class:"comment-title show-txt"},{default:o((()=>[c(" 精彩评论 ")])),_:1}),n(I,{class:"comment"},{default:o((()=>[(t(!0),m(d,null,i($.value,(e=>(t(),s(F,{key:e.id,commentInfo:e},null,8,["commentInfo"])))),128))])),_:1})])),_:1})):f("",!0),S.value.length||$.value.length||x.value?f("",!0):(t(),s(I,{key:2,class:"empty show-txt"},{default:o((()=>[c(" 暂无评论 ")])),_:1})),x.value?(t(),s(I,{key:3,class:"loading"},{default:o((()=>[n(T)])),_:1})):f("",!0)])),_:1})])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-47fa206f"]]);export{S as default};
