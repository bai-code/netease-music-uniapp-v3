import{o as a,c as e,w as s,a as l,r as t,i,b as n,t as c,d as o,u,e as r,f as d,g as f,h as m,j as p,k as g,l as v,m as _,n as y,p as k,v as h,q as b,s as I,x as w,y as x,z as P,A as C,B as $,C as U,F as j,D as z,E as L,G as S,H as T,S as F,I as M,M as R,J as D,K as N,L as A,N as E,O as H}from"./index.88361eb6.js";import{_ as O}from"./_plugin-vue_export-helper.cdc0426e.js";import{_ as W}from"./playlist-temp.7d23835e.js";import{_ as q}from"./music-list-table.1b59f8b2.js";import{_ as B}from"./video-temp.bdb93370.js";import{_ as G}from"./toggle-spread-musicList.6161e08b.js";import"./u-icon.0263866c.js";import"./u-line.c1c06170.js";const J=O({name:"nav-header",data:()=>({})},[["render",function(n,c,o,u,r,d){const f=i;return a(),e(f,{class:"nav-header__container"},{default:s((()=>[l(f,{class:"nav-header"},{default:s((()=>[t(n.$slots,"left",{},(()=>[l(f,{class:"left"})]),!0),t(n.$slots,"center",{},(()=>[l(f,{class:"center"})]),!0),t(n.$slots,"right",{},(()=>[l(f,{class:"right"})]),!0)])),_:3})])),_:3})}],["__scopeId","data-v-7b4aa327"]]),K=O({__name:"nav-title",props:{title:{type:String},linkMode:{type:String,default:"navigateTo"},linkUrl:{type:String}},setup(t){const u=t,r=()=>{const{linkUrl:a,linkMode:e}=u;if(a)try{uni[e]({url:a})}catch(s){}};return(u,d)=>{const f=o,m=i;return a(),e(m,{class:"nav-title",onClick:r},{default:s((()=>[l(f,{class:"title"},{default:s((()=>[n(c(t.title),1)])),_:1}),l(f,{class:"iconfont icon-right"})])),_:1})}}},[["__scopeId","data-v-e8662730"]]),Q=O({__name:"audio-control-panel",setup(t){const w=u(),x=r((()=>w.state.musicInfo)),P=r((()=>w.state.isPlay)),C=d(null),$=d(0),U=()=>{C.value=setInterval((()=>{$.value+=1}),30)},j=a=>{w.commit("changePlayStatus",{isPlay:"play"===a})};f(P,(a=>{a?U():(clearInterval(C.value),C.value=null)}),{immediate:!0});const z=()=>{w.dispatch("changeMusic",{})};return m((()=>{P.value&&(clearInterval(C.value),U())})),p((()=>{clearInterval(C.value)})),(t,u)=>{const r=b,d=I,f=o,m=i,p=g(v("toggle-spread-musicList"),G);return a(),e(m,{class:"audio-control-panel"},{default:s((()=>[l(m,{class:"music-info"},{default:s((()=>[l(d,{class:"image","open-type":"navigate",url:"/subPackages/music-detail/music-detail"},{default:s((()=>[l(r,{src:_(x).picUrl,class:"image",style:y({transform:`rotate(${$.value}deg)`}),mode:"aspecFill"},null,8,["src","style"])])),_:1}),l(m,{class:"music-name"},{default:s((()=>[l(f,{class:"name"},{default:s((()=>[n(c(_(x).name),1)])),_:1}),l(f,{class:"singer"},{default:s((()=>[n("  -  "+c(_(x)._singer),1)])),_:1})])),_:1})])),_:1}),l(m,{class:"controls",ref:"domRef"},{default:s((()=>[l(m,{class:"play-pause"},{default:s((()=>[k(l(m,{class:"pause",onClick:u[0]||(u[0]=a=>j("pause"))},{default:s((()=>[l(f,{class:"iconfont icon-pause"})])),_:1},512),[[h,_(P)]]),k(l(m,{class:"play",onClick:u[1]||(u[1]=a=>j("play"))},{default:s((()=>[l(f,{class:"iconfont icon-play"})])),_:1},512),[[h,!_(P)]])])),_:1}),l(m,{class:"next",onClick:z},{default:s((()=>[l(f,{class:"iconfont icon-next"})])),_:1}),l(m,{class:"list"},{default:s((()=>[l(p)])),_:1})])),_:1},512)])),_:1})}}},[["__scopeId","data-v-d3a2d3de"]]),V=O({__name:"home",setup(t){const f=d(1),m=d(0),p=u(),k=r((()=>p.state.musicInfo)),h=d([]),O=()=>{L({url:"/subPackages/search/search"})},G=w([]),V=d([]),X=r((()=>p.state.rankingInfo.mainRankingList)),Y=w([]),Z=d(1),aa=w([]),ea=w([]),sa=d(0),la=d([]),ta=d(),ia=d(!1),na=async a=>{const{detail:{scrollTop:e}}=a;if(e>0&&0===Y.value.length){if(ia.value)return;if(ia.value=!0,await(async()=>{const{artists:a=[]}=await p.dispatch("getInfo",{path:"/top/artists?limit=8"});Y.value=a})(),(async()=>{const{result:a}=await p.dispatch("getInfo",{path:"/personalized/newsong?limit=5"});V.value=A({list:a,singerName:"artists",nest:"song",reName:"artist"})})(),0===la.value.length){const{offsetWidth:a,offsetHeight:e}=ta.value.$el;la.value=S({width:a,height:e,gutter:5,domSize:50,num:8})}ia.value=!1}const s=aa.value.length;if(e>=100&&0===s){if(ia.value)return;ia.value=!0,await(async()=>{const{result:a}=await p.dispatch("getInfo",{path:"/personalized/privatecontent/list?limit=4"});aa.value=a})(),(async()=>{const{result:a=[]}=await p.dispatch("getInfo",{path:"/personalized/mv"});ea.value=C({list:a})})(),ia.value=!1}};return x((()=>{const{platform:a,screenWidth:e}=P();f.value="ios"===a?2:1,m.value=e/1080*420+"px",sa.value=(new Date).getDate(),(async()=>{const{banners:a=[]}=await p.dispatch("getInfo",{path:`/banner?type=${f.value}`});h.value=a})(),(async()=>{const{result:a=[]}=await p.dispatch("getInfo",{path:"/personalized?limit=10"});G.value=C({list:a})})(),(async()=>{p.dispatch("rankingInfo/getRankingList")})()})),(t,u)=>{const r=T,d=o,f=i,w=g(v("nav-header"),J),x=b,P=E,C=F,S=I,A=g(v("nav-title"),K),ia=g(v("playlist-temp"),W),ca=M,oa=g(v("music-list-table"),q),ua=H,ra=R,da=g(v("video-temp"),B),fa=g(v("audio-control-panel"),Q);return a(),e(f,{class:"home-container"},{default:s((()=>[l(w,{class:"search"},{center:s((()=>[l(f,{class:"search"},{default:s((()=>[l(f,{class:"content",onClick:O},{default:s((()=>[l(r,{type:"search"}),l(d,{class:"placeholder"},{default:s((()=>[n("搜索歌曲/歌手")])),_:1})])),_:1})])),_:1})])),_:1}),l(ca,{class:"home-content","scroll-y":"",onScroll:na},{default:s((()=>[l(C,{"indicator-dots":!0,autoplay:!0,interval:5e3,"indicator-active-color":"#EC4141",circular:"",class:"swiper-container"},{default:s((()=>[(a(!0),$(j,null,U(h.value,(t=>(a(),e(P,{key:t.id,class:"swiper-item",onClick:a=>(async a=>{const{url:e,targetType:s,targetId:l}=a;if(e)L({url:`/subPackages/external-website/external-website?url=${a.url}`});else if(1===s){const{songs:a=[]}=await p.dispatch("getInfo",{path:`/song/detail?ids=${l}`});N({musicInfo:a[0]})}else 1e3===s?L({url:`/subPackages/song-list/song-list?pid=${l}`}):10===s&&L({url:`/subPackages/song-list/song-list?pid=${l}&isAlbum=true`})})(t),style:y({height:m.value})},{default:s((()=>[l(x,{class:"pic",mode:"scaleToFill",src:t.pic},null,8,["src"])])),_:2},1032,["onClick","style"])))),128))])),_:1}),l(f,{class:"other"},{default:s((()=>[l(f,{class:"list-container"},{default:s((()=>[l(f,{class:"daily item"},{default:s((()=>[l(S,{"open-type":"navigate",url:"/subPackages/recommend-daily/recommend-daily"},{default:s((()=>[l(f,{class:"item-c"},{default:s((()=>[l(f,{class:"iconfont icon-daily"},{default:s((()=>[l(d,{class:"date"},{default:s((()=>[n(c(sa.value),1)])),_:1})])),_:1}),l(f,{class:"txt"},{default:s((()=>[n(" 每日推荐 ")])),_:1})])),_:1})])),_:1})])),_:1}),l(f,{class:"song-list item"},{default:s((()=>[l(S,{"open-type":"navigate",url:"/subPackages/recommend-playlist/recommend-playlist"},{default:s((()=>[l(f,{class:"item-c"},{default:s((()=>[l(f,{class:"iconfont icon-songlist"}),l(f,{class:"txt"},{default:s((()=>[n(" 歌单 ")])),_:1})])),_:1})])),_:1})])),_:1}),l(f,{class:"ranking item"},{default:s((()=>[l(S,{"open-type":"navigate",url:"/subPackages/ranking-list/ranking-list"},{default:s((()=>[l(f,{class:"item-c"},{default:s((()=>[l(f,{class:"iconfont icon-ranking"}),l(f,{class:"txt"},{default:s((()=>[n(" 排行榜 ")])),_:1})])),_:1})])),_:1})])),_:1}),l(f,{class:"daily item"},{default:s((()=>[l(S,{"open-type":"navigate",url:""},{default:s((()=>[l(f,{class:"item-c"},{default:s((()=>[l(f,{class:"iconfont icon-daily"}),l(f,{class:"txt"},{default:s((()=>[n(" 占位 ")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),l(f,{class:"recommend-playlist"},{default:s((()=>[l(A,{title:"推荐歌单",linkUrl:"/subPackages/recommend-playlist/recommend-playlist"}),l(ca,{"scroll-x":"true",class:"scroll-container"},{default:s((()=>[(a(!0),$(j,null,U(_(G),(t=>(a(),e(f,{key:t.id,class:"scroll-item"},{default:s((()=>[l(ia,{musicInfo:t},null,8,["musicInfo"])])),_:2},1024)))),128))])),_:1})])),_:1}),l(f,{class:"new-song"},{default:s((()=>[l(A,{title:"新歌推荐",linkUrl:"/subPackages/new-song/new-song"}),l(f,{class:"new-song-content"},{default:s((()=>[l(oa,{musicList:V.value,showOther:!1},null,8,["musicList"])])),_:1})])),_:1}),_(X).length>0?(a(),e(f,{key:0,class:"ranking-list"},{default:s((()=>[l(A,{title:"热门榜单",linkUrl:"/subPackages/ranking-list/ranking-list"}),l(C,{interval:3e3,duration:500,"next-margin":"50rpx"},{default:s((()=>[(a(!0),$(j,null,U(_(X),(t=>(a(),e(P,{key:t&&t.id},{default:s((()=>[l(x,{src:t&&t.coverImgUrl,mode:"scaleToFill",onClick:a=>{var e;(e=t.id)&&L({url:`/subPackages/playlist-detail/playlist-detail?pid=${e}`})}},null,8,["src","onClick"]),t&&t.tracks?(a(),e(f,{key:0,class:"s-item"},{default:s((()=>[(a(!0),$(j,null,U(t.tracks.slice(0,3),((i,o)=>(a(),e(f,{class:D(["item","overflow",{active:i.id===_(k).id}]),key:i.id,onClick:a=>((a,e)=>{N({musicList:a,index:e})})(t.tracks.slice(0,3),o)},{default:s((()=>[n(c(o+1)+". "+c(i.name)+" ",1),l(d,{class:"singer overflow"},{default:s((()=>[n(" - "+c(i._singer),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:2},1024)):z("",!0)])),_:2},1024)))),128))])),_:1})])),_:1})):z("",!0),l(f,{class:"hot-singer"},{default:s((()=>[l(A,{title:"热门歌手",linkUrl:"/subPackages/singer-list/singer-list"}),l(ra,{ref_key:"movableRef",ref:ta},{default:s((()=>[la.value.length>0?(a(!0),$(j,{key:0},U(_(Y),((t,i)=>(a(),e(ua,{class:"movable-item",direction:"all",key:t.id,x:la.value[i].left,y:la.value[i].top,inertia:!0,scale:"true","scale-min":"0.5","scale-max":"1.5",animation:"",onClick:a=>{var e;(e=t.id)&&L({url:`/subPackages/singer-detail/singer-detail?id=${e}`})},onChange:a=>(a=>{a!==Z.value&&(Z.value=a)})(i),style:y({zIndex:Z.value===i?9:1})},{default:s((()=>[l(x,{src:t.img1v1Url,class:"s-pic",mode:"scaleToFill"},null,8,["src"])])),_:2},1032,["x","y","onClick","onChange","style"])))),128)):z("",!0)])),_:1},512)])),_:1}),l(f,{class:"personalized"},{default:s((()=>[l(A,{title:"独家放送",linkUrl:"/subPackages/exclusive-broadcast/exclusive-broadcast"}),l(f,{class:"personalized-content"},{default:s((()=>[(a(!0),$(j,null,U(_(aa),(s=>(a(),e(da,{key:s.id,videoInfo:s},null,8,["videoInfo"])))),128))])),_:1})])),_:1}),l(f,{class:"recommend-mv"},{default:s((()=>[l(A,{title:"推荐mv",linkUrl:"/pages/video/video",linkMode:"switchTab"}),l(f,{class:"mv-content"},{default:s((()=>[(a(!0),$(j,null,U(_(ea),(s=>(a(),e(da,{key:s.id,videoInfo:s},null,8,["videoInfo"])))),128))])),_:1})])),_:1})])),_:1})])),_:1}),l(fa)])),_:1})}}},[["__scopeId","data-v-4c900d82"]]);export{V as default};
